# CloudWatch, CloudTrail

## CloudWatch

* AWS에서 제공하는 AWS 서비스 전반에 대한 모니터링 서비스 : 퍼포먼스 체크
* 기능
  * 로그
  * 경보
  * 이벤트
* 기타 로그를 위한 대시보드 등의 기능 제공

#### CloudWatch 로그

* AWS 내외의 로그를 모아 보관하고 사용자에게 전달
* 주요 서비스들에 대한 모니터링(로그, 메트릭 등) 제공
  * EC2, Autoscaling Groups, ELB, Route53
  * CloudFront, EBS, Storage Gateway 등등

* 주요 서비스의 출력 결과 기록(Lambda 등)
* 사용자가 직접 로그 그룹을 만들어 외부로부터 로그를 적재 가능
  * 주로 온프레미스의 로그를 저장 및 사용
* 로그를 쿼리 형식으로 분석 가능한 Insight 활용 가능

#### CloudWatch 이벤트

* 일정 주기 혹은 AWS의 여러 이벤트를 감지해 다른 AWS 서비스를 (SNS, Lambda 등) 호출하는 규칙
  * EventBridge 규칙과 동일

* 일정 주기로 이벤트 생성 가능
  * 예 : 매시 정각마다 하루에 쌓인 로그를 분석
* AWS의 여러 이벤트를 잡아 생성

#### CloudWatch 경보

* 로그를 기반으로 지표를 생성해서 특정 지표의 조건에 따라 경보 발생
  * 경보는 다른 서비스(SNS를 통해) 호출 가능
* 예시
  * CPU 사용량이 일정 수준 이상이라면 ~
  * 호출 Lambda에 에러가 발생한다면 ~

<br>

## CloudTrail

* AWS의 보안 및 감사를 위한 서비스 : 감사(CCTV)
* 여러 서비스에 대해 API 이용 로그 등을 제공
  * API 호출의 시간 및 결과, 에러, 사용 인증 정보 등을 기록
  * S3와 Lambda의 경우 따로 활성화가 필요
  * AWS CLI, 콘솔 이용, API 호출 등 모든 이벤트가 대상
    * 몇몇 Data API의 경우 수동으로 활성화 필요(S3, Lambda, DynamoDB 등)

<br>

## 비교

| CloudTrail                                       | CloudWatch                                                   |
| ------------------------------------------------ | ------------------------------------------------------------ |
| **감시**                                         | **퍼포먼스 체크**                                            |
| AWS의 모든 서비스가 사용될 때마다 사용 로그 저장 | AWS의 서비스 뿐만 아니라 어플리케이션의 로그 및 동작 로그 취합 |
| AWS가 언제 어디서 누구에 의해 사용 되었는가?     | 어플리케이션이 어떻게 동작하였는가? <br>무슨 버그가 있었는가?<br>메모리는 얼마나 소모되었는가? |
| 단순하게 AWS 사용 로그만 저장                    | 대시보드 및 알람 등 모니터링을 위한 서비스 제공              |

